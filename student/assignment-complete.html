<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>
    <link
      media="screen"
      rel="stylesheet"
      type="text/css"
      href="css/call-reservation.css"
    />

    <style></style>
    <script
      type="text/javascript"
      src="//dapi.kakao.com/v2/maps/sdk.js?appkey=d2481bf8dd089370ad295dd73d94a65a"
    ></script>
    <script src="../src/jquery.js"></script>
    <script src="../src/map.js"></script>
    <script src="../src/marker.js"></script>
    <script src="../src/location.js"></script>
    <script>
      let clicked = 0;
      $(document).ready(function () {
        StartMap(function () {
          let driverID = 1;
          let studentID = 2;
          try {
            let driverLoc = new Location(driverID, function (loc) {
              let driverMarker = CreateMarker(StarMarkerSrc, loc.pos);
              loc.awakeInterval(1000, function (pos) {
                MarkerLocationChange(driverMarker, {
                  latitude: pos.lat + 0.0001 * clicked,
                  longitude: pos.lng,
                });
              });
            });

            let studentLoc = new Location(studentID, function (loc) {
              let studentMarker = CreateMarker(StarMarkerSrc, loc.pos);
              loc.awakeInterval(1000, function (pos) {
                MarkerLocationChange(studentMarker, {
                  latitude: pos.lat - 0.0001 * clicked,
                  longitude: pos.lng,
                });
              });
            });
          } catch (e) {
            console.log(e.stack);
          }
        });
        $("#cancel-reservation").on("click", function () {
          $.ajax({
            url: window.location.origin + "/reservation-delete",
            data: {
              id: top.args["id"],
            },
            error: function (jqXHR, textStatus, errorThrown) {
              console.log("Error");
            },
            success: function (data, textStatus, jqXHR) {
              console.log("Move to ConfirmReservation");
              window.location.href = "confirm-reservation";
            },
          });
        });
        $("#send-message").on("click",function (e) {
          //e.preventDefault();
          clicked = clicked + 1;
        });
      });
    </script>
    <link rel="stylesheet" type="text/css" href="../css/style.css" />
    <link rel="stylesheet" type="text/css" href="css/assignment-complete.css" />
    <link rel="stylesheet" type="text/css" href="../css/navigator.css" />
    <script src="../src/navigator.js"></script>
  </head>
  <body>
    <div id="map"></div>
    <div id="after-assigning-driver">
      <div id="real-time-information">
        <div id="minute-left">
          <h4>기사님께서 이동 중이십니다. (%분 후 도착)</h4>
        </div>
        <div id="profile-image"></div>

        <div id="name"></div>

        <div id="car-information">
          <h4>차량: %호차</h4>
        </div>
      </div>

      <div id="control">
        <div id="make-call">
          <h3>전화하기</h3>
        </div>

        <div id="send-message">
          <h3>메시지 보내기</h3>
        </div>

        <div id="cancel-reservation">
          <h3>취소하기</h3>
        </div>
      </div>
    </div>
  </body>
</html>
